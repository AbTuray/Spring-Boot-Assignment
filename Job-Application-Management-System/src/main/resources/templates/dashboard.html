<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Applicant Dashboard</title>
</head>
<body>
<h2>Welcome, <span th:text="${applicant.fullName}"></span>!</h2>

<!-- Available Jobs -->
<h3>Available Jobs</h3>
<table border="1">
  <thead>
  <tr>
    <th>Title</th>
    <th>Location</th>
    <th>Status</th>
    <th>Apply</th>
  </tr>
  </thead>
  <tbody>
  <tr th:each="job : ${jobs}">
    <td th:text="${job.title}"></td>
    <td th:text="${job.location}"></td>
    <td th:text="${job.status}"></td>
    <td>
      <form th:action="@{'/applicant/apply/' + ${job.id}}" method="post" enctype="multipart/form-data">
        <input type="file" name="resume" accept=".pdf,.doc,.docx" required>
        <button type="submit"
                th:disabled="${#lists.contains(applications.stream().map(a -> a.job.id).toList(), job.id)}">
          Apply
        </button>
      </form>
    </td>
  </tr>
  </tbody>
</table>

<!-- Your Applications -->
<h3>Your Applications</h3>
<table border="1">
  <thead>
  <tr>
    <th>Job Title</th>
    <th>Status</th>
    <th>Resume</th>
  </tr>
  </thead>
  <tbody>
  <tr th:each="app : ${applications}">
    <td th:text="${app.job.title}"></td>
    <td th:text="${app.status}"></td>
    <td>
      <a th:if="${app.resumePath}" th:href="@{'/applicant/download/' + ${app.id}}">Download</a>
      <span th:if="${!app.resumePath}">No File</span>
    </td>
  </tr>
  </tbody>
</table>

</body>
</html>
